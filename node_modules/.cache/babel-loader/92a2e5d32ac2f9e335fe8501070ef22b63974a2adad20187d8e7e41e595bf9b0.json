{"ast":null,"code":"import { isHex } from '../../utils/data/isHex.js';\nimport { getEventSelector } from '../../utils/hash/getEventSelector.js';\nimport { getFunctionSelector } from '../../utils/hash/getFunctionSelector.js';\nimport { isAddress } from '../address/isAddress.js';\nexport function getAbiItem(_ref) {\n  let {\n    abi,\n    args = [],\n    name\n  } = _ref;\n  const isSelector = isHex(name, {\n    strict: false\n  });\n  const abiItems = abi.filter(abiItem => {\n    if (isSelector) {\n      if (abiItem.type === 'function') return getFunctionSelector(abiItem) === name;\n      if (abiItem.type === 'event') return getEventSelector(abiItem) === name;\n      return false;\n    }\n    return 'name' in abiItem && abiItem.name === name;\n  });\n  if (abiItems.length === 0) return undefined;\n  if (abiItems.length === 1) return abiItems[0];\n  for (const abiItem of abiItems) {\n    if (!('inputs' in abiItem)) continue;\n    if (!args || args.length === 0) {\n      if (!abiItem.inputs || abiItem.inputs.length === 0) return abiItem;\n      continue;\n    }\n    if (!abiItem.inputs) continue;\n    if (abiItem.inputs.length === 0) continue;\n    if (abiItem.inputs.length !== args.length) continue;\n    const matched = args.every((arg, index) => {\n      const abiParameter = 'inputs' in abiItem && abiItem.inputs[index];\n      if (!abiParameter) return false;\n      return isArgOfType(arg, abiParameter);\n    });\n    if (matched) return abiItem;\n  }\n  return abiItems[0];\n}\nexport function isArgOfType(arg, abiParameter) {\n  const argType = typeof arg;\n  const abiParameterType = abiParameter.type;\n  switch (abiParameterType) {\n    case 'address':\n      return isAddress(arg);\n    case 'bool':\n      return argType === 'boolean';\n    case 'function':\n      return argType === 'string';\n    case 'string':\n      return argType === 'string';\n    default:\n      {\n        if (abiParameterType === 'tuple' && 'components' in abiParameter) return Object.values(abiParameter.components).every((component, index) => {\n          return isArgOfType(Object.values(arg)[index], component);\n        });\n        // `(u)int<M>`: (un)signed integer type of `M` bits, `0 < M <= 256`, `M % 8 == 0`\n        // https://regexr.com/6v8hp\n        if (/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(abiParameterType)) return argType === 'number' || argType === 'bigint';\n        // `bytes<M>`: binary type of `M` bytes, `0 < M <= 32`\n        // https://regexr.com/6va55\n        if (/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(abiParameterType)) return argType === 'string' || arg instanceof Uint8Array;\n        // fixed-length (`<type>[M]`) and dynamic (`<type>[]`) arrays\n        // https://regexr.com/6va6i\n        if (/[a-z]+[1-9]{0,3}(\\[[0-9]{0,}\\])+$/.test(abiParameterType)) {\n          return Array.isArray(arg) && arg.every(x => isArgOfType(x, {\n            ...abiParameter,\n            // Pop off `[]` or `[M]` from end of type\n            type: abiParameterType.replace(/(\\[[0-9]{0,}\\])$/, '')\n          }));\n        }\n        return false;\n      }\n  }\n}","map":{"version":3,"names":["isHex","getEventSelector","getFunctionSelector","isAddress","getAbiItem","_ref","abi","args","name","isSelector","strict","abiItems","filter","abiItem","type","length","undefined","inputs","matched","every","arg","index","abiParameter","isArgOfType","argType","abiParameterType","Object","values","components","component","test","Uint8Array","Array","isArray","x","replace"],"sources":["/Users/toji.inoue/Desktop/web3-sotuken/node_modules/viem/utils/abi/getAbiItem.ts"],"sourcesContent":["import type { Abi, AbiParameter, Address } from 'abitype'\n\nimport type { GetFunctionArgs, InferItemName } from '../../types/contract.js'\nimport type { Hex } from '../../types/misc.js'\nimport { isHex } from '../../utils/data/isHex.js'\nimport { getEventSelector } from '../../utils/hash/getEventSelector.js'\nimport { getFunctionSelector } from '../../utils/hash/getFunctionSelector.js'\nimport { isAddress } from '../address/isAddress.js'\n\nexport type GetAbiItemParameters<\n  TAbi extends Abi | readonly unknown[] = Abi,\n  TItemName extends string = string,\n> = {\n  abi: TAbi\n  name: InferItemName<TAbi, TItemName> | Hex\n} & Partial<GetFunctionArgs<TAbi, TItemName>>\n\nexport type GetAbiItemReturnType<\n  TAbi extends Abi | readonly unknown[] = Abi,\n  TItemName extends string = string,\n> = Extract<\n  TAbi[number],\n  {\n    name: TItemName\n  }\n>\n\nexport function getAbiItem<\n  const TAbi extends Abi | readonly unknown[],\n  TItemName extends string,\n>({\n  abi,\n  args = [],\n  name,\n}: GetAbiItemParameters<TAbi, TItemName>): GetAbiItemReturnType<\n  TAbi,\n  TItemName\n> {\n  const isSelector = isHex(name, { strict: false })\n\n  const abiItems = (abi as Abi).filter((abiItem) => {\n    if (isSelector) {\n      if (abiItem.type === 'function')\n        return getFunctionSelector(abiItem) === name\n      if (abiItem.type === 'event') return getEventSelector(abiItem) === name\n      return false\n    }\n    return 'name' in abiItem && abiItem.name === name\n  })\n\n  if (abiItems.length === 0) return undefined as any\n  if (abiItems.length === 1) return abiItems[0] as any\n\n  for (const abiItem of abiItems) {\n    if (!('inputs' in abiItem)) continue\n    if (!args || args.length === 0) {\n      if (!abiItem.inputs || abiItem.inputs.length === 0) return abiItem as any\n      continue\n    }\n    if (!abiItem.inputs) continue\n    if (abiItem.inputs.length === 0) continue\n    if (abiItem.inputs.length !== args.length) continue\n    const matched = (args as readonly unknown[]).every((arg, index) => {\n      const abiParameter = 'inputs' in abiItem && abiItem.inputs![index]\n      if (!abiParameter) return false\n      return isArgOfType(arg, abiParameter as AbiParameter)\n    })\n    if (matched) return abiItem as any\n  }\n  return abiItems[0] as any\n}\n\nexport function isArgOfType(arg: unknown, abiParameter: AbiParameter): boolean {\n  const argType = typeof arg\n  const abiParameterType = abiParameter.type\n  switch (abiParameterType) {\n    case 'address':\n      return isAddress(arg as Address)\n    case 'bool':\n      return argType === 'boolean'\n    case 'function':\n      return argType === 'string'\n    case 'string':\n      return argType === 'string'\n    default: {\n      if (abiParameterType === 'tuple' && 'components' in abiParameter)\n        return Object.values(abiParameter.components).every(\n          (component, index) => {\n            return isArgOfType(\n              Object.values(arg as unknown[] | Record<string, unknown>)[index],\n              component as AbiParameter,\n            )\n          },\n        )\n\n      // `(u)int<M>`: (un)signed integer type of `M` bits, `0 < M <= 256`, `M % 8 == 0`\n      // https://regexr.com/6v8hp\n      if (\n        /^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(\n          abiParameterType,\n        )\n      )\n        return argType === 'number' || argType === 'bigint'\n\n      // `bytes<M>`: binary type of `M` bytes, `0 < M <= 32`\n      // https://regexr.com/6va55\n      if (/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(abiParameterType))\n        return argType === 'string' || arg instanceof Uint8Array\n\n      // fixed-length (`<type>[M]`) and dynamic (`<type>[]`) arrays\n      // https://regexr.com/6va6i\n      if (/[a-z]+[1-9]{0,3}(\\[[0-9]{0,}\\])+$/.test(abiParameterType)) {\n        return (\n          Array.isArray(arg) &&\n          arg.every((x: unknown) =>\n            isArgOfType(x, {\n              ...abiParameter,\n              // Pop off `[]` or `[M]` from end of type\n              type: abiParameterType.replace(/(\\[[0-9]{0,}\\])$/, ''),\n            } as AbiParameter),\n          )\n        )\n      }\n\n      return false\n    }\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}