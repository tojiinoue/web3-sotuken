{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import{Form,Button}from\"react-bootstrap\";import{CSVLink,CSVDownload}from\"react-csv\";import{Contracts_MetaMask}from\"../../../contract/contracts\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function getCurrentDateTime(){const now=new Date();const year=now.getFullYear();const month=String(now.getMonth()+1).padStart(2,'0');// 月は0から始まるため+1し、2桁にパディング\nconst day=String(now.getDate()).padStart(2,'0');// 日を2桁にパディング\nconst hours=String(now.getHours()).padStart(2,'0');// 時を2桁にパディング\nconst minutes=String(now.getMinutes()).padStart(2,'0');// 分を2桁にパディング\nconst seconds=String(now.getSeconds()).padStart(2,'0');// 秒を2桁にパディング\nconst formattedDateTime=`${year}${month}${day}${hours}${minutes}${seconds}`;return formattedDateTime;}function Create_csvlink(props){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CSVLink,{filename:`students_data_${getCurrentDateTime()}.csv`,variant:\"primary\",data:props.cont[0],children:\"\\u3053\\u3061\\u3089\\u304B\\u3089\\u5B66\\u751F\\u306E\\u6210\\u7E3E\\u30C7\\u30FC\\u30BF\\u3092\\u30C0\\u30A6\\u30F3\\u30ED\\u30FC\\u30C9\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(CSVLink,{filename:`quizs_data_${getCurrentDateTime()}.csv`,variant:\"primary\",data:props.cont[1],children:\"\\u3053\\u3061\\u3089\\u304B\\u3089\\u5C0F\\u30C6\\u30B9\\u30C8\\u306E\\u7D71\\u8A08\\u30C7\\u30FC\\u30BF\\u3092\\u30C0\\u30A6\\u30F3\\u30ED\\u30FC\\u30C9\"})})]});}function View_result(props){let contract=new Contracts_MetaMask();const[results,setResults]=useState([]);const[data_for_survey_users,setData_for_survey_users]=useState(null);const[data_for_survey_quizs,setData_for_survey_quizs]=useState(null);const[usersData,setUsersData]=useState(null);const[quizsData,setQuizsData]=useState(null);const[csvdownloader,setCsvdownloader]=useState(false);const handle_export_csv=()=>{//console.log(data_for_survey_users);\nconst users_data=[Object.keys(data_for_survey_users[0])];for(let i=0;i<data_for_survey_users.length;i++){users_data.push([data_for_survey_users[i].user,Number(data_for_survey_users[i].create_quiz_count).toString(),(Number(data_for_survey_users[i].result)/10**18).toString(),Number(data_for_survey_users[i].answer_count).toString()]);}const quizs_data=[Object.keys(data_for_survey_quizs[0])];for(let i=0;i<data_for_survey_quizs.length;i++){quizs_data.push([(Number(data_for_survey_quizs[i].reward)/10**18).toString(),Number(data_for_survey_quizs[i].respondent_count).toString()]);}setUsersData(users_data);setQuizsData(quizs_data);setCsvdownloader(true);};async function get_data_for_survey(){setData_for_survey_users(await contract.get_data_for_survey_users());setData_for_survey_quizs(await contract.get_data_for_survey_quizs());}//初回のみ実行\nuseEffect(()=>{get_data_for_survey();props.cont.get_results().then(result=>{console.log(result);setResults(result);});},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"mypage\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"row\",children:[/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:()=>handle_export_csv(),children:\"\\u6210\\u7E3E\\u30C7\\u30FC\\u30BF\\u306ECSV\\u30D5\\u30A1\\u30A4\\u30EB\\u306E\\u51FA\\u529B\"}),csvdownloader===true&&/*#__PURE__*/_jsx(Create_csvlink,{cont:[usersData,quizsData]})]}),/*#__PURE__*/_jsxs(\"table\",{className:\"table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{children:\"address\"}),/*#__PURE__*/_jsx(\"th\",{children:\"\\u5F97\\u70B9\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:results.map((item,index)=>{return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:item.student}),/*#__PURE__*/_jsxs(\"td\",{children:[Number(item.result)/10**18,\"\\u70B9\"]})]});})})]})]});}export default View_result;","map":{"version":3,"names":["React","useState","useEffect","Form","Button","CSVLink","CSVDownload","Contracts_MetaMask","jsx","_jsx","jsxs","_jsxs","getCurrentDateTime","now","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","formattedDateTime","Create_csvlink","props","children","filename","variant","data","cont","View_result","contract","results","setResults","data_for_survey_users","setData_for_survey_users","data_for_survey_quizs","setData_for_survey_quizs","usersData","setUsersData","quizsData","setQuizsData","csvdownloader","setCsvdownloader","handle_export_csv","users_data","Object","keys","i","length","push","user","Number","create_quiz_count","toString","result","answer_count","quizs_data","reward","respondent_count","get_data_for_survey","get_data_for_survey_users","get_data_for_survey_quizs","get_results","then","console","log","className","class","onClick","map","item","index","student"],"sources":["/Users/toji.inoue/Desktop/卒業研究_井上登司フォルダ/web3-sotuken/src/pages/admin_page/components/view_results.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Form, Button } from \"react-bootstrap\";\nimport { CSVLink, CSVDownload } from \"react-csv\";\nimport { Contracts_MetaMask } from \"../../../contract/contracts\";\n\nfunction getCurrentDateTime() {\n    const now = new Date();\n    const year = now.getFullYear();\n    const month = String(now.getMonth() + 1).padStart(2, '0'); // 月は0から始まるため+1し、2桁にパディング\n    const day = String(now.getDate()).padStart(2, '0'); // 日を2桁にパディング\n    const hours = String(now.getHours()).padStart(2, '0'); // 時を2桁にパディング\n    const minutes = String(now.getMinutes()).padStart(2, '0'); // 分を2桁にパディング\n    const seconds = String(now.getSeconds()).padStart(2, '0'); // 秒を2桁にパディング\n\n    const formattedDateTime = `${year}${month}${day}${hours}${minutes}${seconds}`;\n    return formattedDateTime;\n}\n\nfunction Create_csvlink(props) {\n    return (\n        <div>\n            <div><CSVLink filename={`students_data_${getCurrentDateTime()}.csv`} variant=\"primary\" data={props.cont[0]}>こちらから学生の成績データをダウンロード</CSVLink></div>\n            <div><CSVLink filename={`quizs_data_${getCurrentDateTime()}.csv`} variant=\"primary\" data={props.cont[1]}>こちらから小テストの統計データをダウンロード</CSVLink></div>\n        </div>\n    );\n\n}\n\nfunction View_result(props) {\n\n    let contract = new Contracts_MetaMask();\n    const [results, setResults] = useState([]);\n    const [data_for_survey_users, setData_for_survey_users] = useState(null);\n    const [data_for_survey_quizs, setData_for_survey_quizs] = useState(null);\n    const [usersData, setUsersData] = useState(null);\n    const [quizsData, setQuizsData] = useState(null);\n    const [csvdownloader, setCsvdownloader] = useState(false);\n\n    const handle_export_csv = () => {\n        //console.log(data_for_survey_users);\n\n        const users_data = [\n            Object.keys(data_for_survey_users[0])\n        ]\n        for (let i = 0; i < data_for_survey_users.length; i++) {\n            users_data.push([data_for_survey_users[i].user, Number(data_for_survey_users[i].create_quiz_count).toString(), (Number(data_for_survey_users[i].result) / (10 ** 18)).toString(), (Number(data_for_survey_users[i].answer_count).toString())]);\n        }\n\n        const quizs_data = [\n            Object.keys(data_for_survey_quizs[0])\n        ]\n        for (let i = 0; i < data_for_survey_quizs.length; i++) {\n            quizs_data.push([(Number(data_for_survey_quizs[i].reward) / (10 ** 18)).toString(), (Number(data_for_survey_quizs[i].respondent_count)).toString()]);\n        }\n\n        setUsersData(users_data);\n        setQuizsData(quizs_data);\n        setCsvdownloader(true);\n    }\n\n    async function get_data_for_survey() {\n        setData_for_survey_users(await contract.get_data_for_survey_users());\n        setData_for_survey_quizs(await contract.get_data_for_survey_quizs());\n    }\n\n    //初回のみ実行\n    useEffect(() => {\n\n        get_data_for_survey();\n        props.cont.get_results().then((result) => {\n            console.log(result);\n            setResults(result);\n        });\n    }, []);\n\n    return (\n        <div className=\"mypage\">\n\n            <div class=\"row\">\n                <Button variant=\"primary\" onClick={() => handle_export_csv()}>成績データのCSVファイルの出力</Button>\n                {csvdownloader === true && <Create_csvlink cont={[usersData, quizsData]} />}\n            </div>\n            <table className=\"table\">\n                <thead>\n                    <tr>\n                        <th>#</th>\n                        <th>address</th>\n                        <th>得点</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {results.map((item, index) => {\n                        return (\n                            <tr>\n                                <td>{index + 1}</td>\n                                <td>{item.student}</td>\n                                <td>{Number(item.result) / 10 ** 18}点</td>\n                            </tr>\n                        );\n                    })}\n                </tbody>\n            </table>\n        </div>\n    );\n}\n\nexport default View_result;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}