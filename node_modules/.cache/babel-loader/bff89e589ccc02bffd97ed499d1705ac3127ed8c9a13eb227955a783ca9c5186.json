{"ast":null,"code":"/**\n * Scopes `request` to the filter ID. If the client is a fallback, it will\n * listen for responses and scope the child transport `request` function\n * to the successful filter ID.\n */\nexport function createFilterRequestScope(client, _ref) {\n  var _client$transport$onR, _client$transport;\n  let {\n    method\n  } = _ref;\n  const requestMap = {};\n  if (client.transport.type === 'fallback') (_client$transport$onR = (_client$transport = client.transport).onResponse) === null || _client$transport$onR === void 0 || _client$transport$onR.call(_client$transport, _ref2 => {\n    let {\n      method: method_,\n      response: id,\n      status,\n      transport\n    } = _ref2;\n    if (status === 'success' && method === method_) requestMap[id] = transport.request;\n  });\n  return id => requestMap[id] || client.request;\n}","map":{"version":3,"names":["createFilterRequestScope","client","_ref","_client$transport$onR","_client$transport","method","requestMap","transport","type","onResponse","call","_ref2","method_","response","id","status","request"],"sources":["/Users/toji.inoue/Desktop/web3-sotuken/node_modules/viem/utils/filters/createFilterRequestScope.ts"],"sourcesContent":["import type { Client } from '../../clients/createClient.js'\nimport type { Transport } from '../../clients/transports/createTransport.js'\nimport type { OnResponseFn } from '../../clients/transports/fallback.js'\nimport type { Chain } from '../../types/chain.js'\nimport type { PublicRpcSchema } from '../../types/eip1193.js'\nimport type { EIP1193RequestFn } from '../../types/eip1193.js'\nimport type { Hex } from '../../types/misc.js'\nimport type { Filter } from '../../types/utils.js'\n\ntype CreateFilterRequestScopeParameters = {\n  method:\n    | 'eth_newFilter'\n    | 'eth_newPendingTransactionFilter'\n    | 'eth_newBlockFilter'\n}\n\ntype FilterRpcSchema = Filter<\n  PublicRpcSchema,\n  { Method: 'eth_getFilterLogs' | 'eth_getFilterChanges' }\n>\n\ntype CreateFilterRequestScopeReturnType = (\n  id: Hex,\n) => EIP1193RequestFn<FilterRpcSchema>\n\n/**\n * Scopes `request` to the filter ID. If the client is a fallback, it will\n * listen for responses and scope the child transport `request` function\n * to the successful filter ID.\n */\nexport function createFilterRequestScope<TChain extends Chain | undefined>(\n  client: Client<Transport, TChain>,\n  { method }: CreateFilterRequestScopeParameters,\n): CreateFilterRequestScopeReturnType {\n  const requestMap: Record<Hex, EIP1193RequestFn> = {}\n\n  if (client.transport.type === 'fallback')\n    client.transport.onResponse?.(\n      ({\n        method: method_,\n        response: id,\n        status,\n        transport,\n      }: Parameters<OnResponseFn>[0]) => {\n        if (status === 'success' && method === method_)\n          requestMap[id as Hex] = transport.request\n      },\n    )\n\n  return ((id) =>\n    requestMap[id] || client.request) as CreateFilterRequestScopeReturnType\n}\n"],"mappings":"AAyBA;;;;;AAKA,OAAM,SAAUA,wBAAwBA,CACtCC,MAAiC,EAAAC,IAAA,EACa;EAAA,IAAAC,qBAAA,EAAAC,iBAAA;EAAA,IAA9C;IAAEC;EAAM,CAAsC,GAAAH,IAAA;EAE9C,MAAMI,UAAU,GAAkC,EAAE;EAEpD,IAAIL,MAAM,CAACM,SAAS,CAACC,IAAI,KAAK,UAAU,EACtC,CAAAL,qBAAA,IAAAC,iBAAA,GAAAH,MAAM,CAACM,SAAS,EAACE,UAAU,cAAAN,qBAAA,eAA3BA,qBAAA,CAAAO,IAAA,CAAAN,iBAAA,EACEO,KAAA,IAKkC;IAAA,IALjC;MACCN,MAAM,EAAEO,OAAO;MACfC,QAAQ,EAAEC,EAAE;MACZC,MAAM;MACNR;IAAS,CACmB,GAAAI,KAAA;IAC5B,IAAII,MAAM,KAAK,SAAS,IAAIV,MAAM,KAAKO,OAAO,EAC5CN,UAAU,CAACQ,EAAS,CAAC,GAAGP,SAAS,CAACS,OAAO;EAC7C,CAAC,CACF;EAEH,OAASF,EAAE,IACTR,UAAU,CAACQ,EAAE,CAAC,IAAIb,MAAM,CAACe,OAAO;AACpC"},"metadata":{},"sourceType":"module","externalDependencies":[]}